# Requirements Document: BR16.4: 公司設定

## Introduction

公司設定功能提供系統層級的公司資料管理，包括管理兩個公司資料（公司資料 1 和公司資料 2），設定公司基本資訊、地址、聯絡方式和銀行資訊。本功能幫助用戶統一管理公司資料，為收據開立等業務提供基礎資料。功能支援在兩個公司資料之間切換，編輯公司資訊，並將資料保存到系統設定中。

## Alignment with Product Vision

本功能支持系統設定的核心目標：
- **統一公司資料管理**：集中管理公司資料，確保公司資料的一致性
- **支援多公司資料**：支援兩個公司資料切換，滿足業務需求
- **提供基礎資料**：為收據開立等業務提供基礎公司資料

## Requirements

### BR16.4.1: 公司資料切換

**User Story**: 作為用戶，我需要在兩個公司資料之間切換，以便管理不同公司的資料。

#### 驗收標準
1. WHEN 用戶打開公司設定頁面時 THEN 系統 SHALL 顯示公司資料切換選項（公司資料 1、公司資料 2）
2. WHEN 用戶切換公司資料時 THEN 系統 SHALL 載入對應的公司資料並顯示在表單中
3. WHEN 用戶切換公司資料時 THEN 系統 SHALL 保持表單驗證狀態
4. IF 當前表單有未保存的變更 AND 用戶切換公司資料時 THEN 系統 SHALL 提示用戶是否保存變更

### BR16.4.2: 公司資料編輯

**User Story**: 作為用戶，我需要編輯公司資料，以便更新公司資訊。

#### 驗收標準
1. WHEN 用戶編輯公司資料時 THEN 系統 SHALL 允許編輯以下欄位：
   - 公司中文名稱（必填）：最多 100 個字符
   - 公司英文名稱（可選）：最多 100 個字符
   - 統一編號（必填）：最多 20 個字符
   - 公司地址（第一行）（必填）：最多 200 個字符
   - 公司地址（第二行）（可選）：最多 200 個字符
   - 聯絡電話（必填）：最多 50 個字符
   - 銀行名稱（必填）：最多 100 個字符
   - 銀行代號（必填）：最多 20 個字符
   - 銀行帳號（必填）：最多 50 個字符
2. WHEN 用戶提交公司資料時 THEN 系統 SHALL 驗證必填欄位
3. IF 必填欄位為空 OR 欄位長度超過限制時 THEN 系統 SHALL 顯示驗證錯誤訊息並阻止提交
4. WHEN 用戶成功保存公司資料時 THEN 系統 SHALL 顯示成功提示
5. WHEN 用戶編輯公司資料時 THEN 系統 SHALL 即時顯示表單驗證狀態

### BR16.4.3: 公司資料保存

**User Story**: 作為用戶，我需要保存公司資料，以便系統能夠為其他業務提供正確的基礎資料。

#### 驗收標準
1. WHEN 用戶保存公司資料時 THEN 系統 SHALL 根據選擇的公司資料編號（1 或 2）保存到對應的設定項
2. WHEN 系統保存公司資料時 THEN 系統 SHALL 使用設定項前綴（`company1_` 或 `company2_`）區分兩個公司資料
3. WHEN 系統保存公司資料時 THEN 系統 SHALL 更新對應的設定項值
4. IF 保存失敗時 THEN 系統 SHALL 顯示錯誤訊息並保持表單狀態
5. WHEN 系統保存公司資料成功時 THEN 系統 SHALL 更新本地狀態以反映最新資料

## Non-Functional Requirements

### Code Architecture and Modularity
- **Single Responsibility Principle**: 每個文件應該有單一、明確的職責
- **Modular Design**: 組件、工具和服務應該隔離且可重用
- **Dependency Management**: 最小化模組之間的相互依賴
- **Clear Interfaces**: 定義組件和層之間的清晰契約

### Performance
- API 響應時間 < 500ms
- 頁面載入時間 < 2 秒
- 表單提交響應時間 < 1 秒

### Security
- 所有已登入用戶可訪問公司設定頁面
- 使用參數化查詢防止 SQL 注入
- 前端輸入驗證和後端驗證

### Reliability
- 公司資料載入穩定
- 公司資料保存可靠
- 公司資料切換流暢

### Usability
- 界面簡潔直觀
- 公司資料切換清晰
- 表單驗證提示清晰


