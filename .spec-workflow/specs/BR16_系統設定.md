# BR16: 系統設定（System Settings）

**定位/目的**: 提供系統層級的基礎資料與參數設定入口，包括服務與模板、使用者與權限、公司與自動化、假日設定等，保障各模組一致性與可配置性。

**路由**
- 系統設定首頁：`/settings`
- 服務設定：`/settings/services`
- 模板設定：`/settings/templates`
- 使用者管理：`/settings/users`
- 公司設定：`/settings/company`
- 自動化設定：`/settings/automation`
- 假日設定：`/settings/holidays`

---

## 功能需求
- 服務設定
  - 新增/編輯服務：代碼、名稱、描述、啟用/停用
  - 預設值：`default_service_type`、`default_execution_months`、`default_use_for_auto_generate`
  - 綁定服務層級 SOP（自動綁定於客戶服務選擇時）
- 模板設定
  - 任務模板：可關聯服務類型與客戶；帶出任務名稱、描述、階段、開始日與期限預設
  - 模板套用策略：客戶專屬優先，其次通用模板
- 使用者管理
  - 新增/編輯使用者：基本資料、底薪、角色（管理員/一般員工）
  - 狀態管理：啟用/停用、重置密碼
- 公司設定
  - 基本資料：公司名稱、統編、地址、聯絡資訊
  - 薪資參數：扣款比例、誤餐費門檻、交通補貼區間金額
- 自動化設定
  - 排程：任務自動生成、報表預先計算、每日摘要產出等 Cron 設定
  - 保護與重試策略：失敗重試、告警通知
- 假日設定
  - 管理國定假日/例假日/公司自訂休假
  - 用於判斷日期類型（影響工時與請假規則）

---

## 驗收標準
- WHEN 管理員設定服務項目 THEN 系統 SHALL 允許設定服務代碼、名稱、描述與啟用狀態
- WHEN 管理員設定任務模板 THEN 系統 SHALL 允許設定執行頻率來源（服務層級繼承）、到期日規則與自動生成屬性
- WHEN 管理員管理使用者 THEN 系統 SHALL 允許設定基本資訊、底薪與權限
- WHEN 管理員設定薪資參數 THEN 系統 SHALL 在薪資計算中生效（見 BR4）
- WHEN 管理員設定假日 THEN 系統 SHALL 於工時/加班/請假校驗時正確生效

---

## 業務規則
- 服務項目可啟用/停用；停用後不得新關聯，但不影響既有資料
- 任務模板可關聯服務類型與/或客戶；套用後的任務配置可被修改，不回寫模板
- RBAC：管理員可存取所有設定；一般員工不可變更設定
- 假日資料為全局唯一來源，供工時/請假/加班校驗之基準

---

## 與其他模組關聯
- BR1 客戶管理：新增/編輯服務時套用服務預設值與模板；SOP 自動綁定
- BR4 薪資管理：薪資參數（扣款比例、誤餐、交通補貼）直接影響結算
- BR6/BR7/BR8：假日與排程設定影響工時、假期、外出之規則與自動化
- BR13/BR14：報表預先計算排程與快取刷新策略


